{"version":3,"sources":["main.js"],"names":["enemy","require","cc","Class","extends","Component","properties","pause","Button","btnSprite","default","type","SpriteFrame","displayName","bomb","Node","gameMusic","AudioSource","useBombClip","AudioClip","enemyGroup","hero","itemGroup","bulletGroup","control","scoreDisplay","Label","bombNoDisplay","onLoad","score","bombNo","string","eState","D","commonInfo","gameState","start","resumeAction","startAction","on","bombOnclick","play","bombNoLabel","getChildByName","getComponent","parseInt","removeEnemy","audioEngine","playEffect","console","log","pauseClick","pauseAction","resume","normalSprite","pressedSprite","hoverSprite","addScore","num","toString","getScore","updateScore","currentScore","scoreData","common","timeFmt","Date","preData","sys","localStorage","getItem","preTopScore","setItem","unshift","JSON","parse","Array","stringify","cannons","node","children","i","length","group","animName","name","anim","Animation","getItemBomb","gameOver","director","loadScene"],"mappings":"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","file":"main.js","sourceRoot":"../../../../assets/Script","sourcesContent":["var enemy = require('enemy');\ncc.Class({\n    \n    extends: cc.Component,\n\n    properties:()=>({\n        pause: cc.Button,\n        btnSprite: {\n            default: [],\n            type: cc.SpriteFrame,\n            displayName:'暂停按钮不同状态的图片',\n        },\n        bomb: cc.Node,\n        gameMusic: {\n            default: null,\n            type: cc.AudioSource\n        },\n        useBombClip: {\n          type: cc.AudioClip,\n          default: null\n        },\n        enemyGroup: {\n            default: null,\n            type: require('enemyGroup'),\n        },\n        hero: {\n            default: null,\n            type: require('hero'),\n        }, \n        itemGroup: {\n            default: null,\n            type: require('itemGroup'),\n        },\n        bulletGroup: {\n            default: null,\n            type: require('bulletGroup'),\n        },\n        control: {\n            default: null,\n            type: require('controlBg'),\n        },\n        \n        scoreDisplay:cc.Label,\n        bombNoDisplay:cc.Label,\n    }),\n    onLoad: function () {\n        this.score = 0;\n        this.bombNo = 1;\n        this.scoreDisplay.string = this.score;\n        this.bombNoDisplay.string = this.bombNo;\n        this.eState = D.commonInfo.gameState.start;\n        this.resumeAction();\n        this.enemyGroup.startAction();\n        this.bulletGroup.startAction();\n        this.itemGroup.startAction();\n        this.bomb.on('touchstart',this.bombOnclick,this);\n        this.gameMusic.play();\n    },\n    \n    bombOnclick: function(){\n        var bombNoLabel = this.bomb.getChildByName('bombNo').getComponent(cc.Label);\n        var bombNo = parseInt(bombNoLabel.string);\n        if (bombNo>0 && this.eState == D.commonInfo.gameState.start){\n            bombNoLabel.string = bombNo-1;\n            this.removeEnemy();\n            cc.audioEngine.playEffect(this.useBombClip, false);\n        } else {\n            console.log('没有炸药');\n        }\n    },\n    pauseClick: function () {//暂停 继续\n        if(this.eState == D.commonInfo.gameState.pause){\n            this.resumeAction();\n            this.eState = D.commonInfo.gameState.start;\n        } else if(this.eState == D.commonInfo.gameState.start) {\n            this.pauseAction();\n            this.eState = D.commonInfo.gameState.pause;\n        }\n    },\n    //游戏继续\n    resumeAction: function(){\n        this.enemyGroup.resumeAction();\n        this.bulletGroup.resumeAction();\n        this.itemGroup.resumeAction();\n        this.control.resumeAction();\n        this.gameMusic.resume();\n        this.pause.normalSprite = this.btnSprite[0];\n        this.pause.pressedSprite = this.btnSprite[1];\n        this.pause.hoverSprite = this.btnSprite[1];\n    },\n    pauseAction: function(){\n        this.enemyGroup.pauseAction();\n        this.bulletGroup.pauseAction();\n        this.gameMusic.pause();\n        this.itemGroup.pauseAction();\n        this.control.pauseAction();\n        \n        this.pause.normalSprite = this.btnSprite[2];\n        this.pause.pressedSprite = this.btnSprite[3];\n        this.pause.hoverSprite = this.btnSprite[3];           \n    },\n    addScore: function (num) {\n        this.score += num;\n        // if(this.boss.node != null && this.score >= 1000){\n        //     this.boss.node.group = 'enemy';\n        // }\n        this.scoreDisplay.string = this.score.toString();\n    },\n    getScore: function(){\n        return parseInt(this.scoreDisplay.string);\n    },\n    updateScore: function() {\n        var currentScore = this.scoreDisplay.string;\n        var scoreData = {\n            'score':currentScore,\n            'time': D.common.timeFmt(new Date(),'yyyy-MM-dd hh:mm:ss'),\n        };\n        var preData = cc.sys.localStorage.getItem('score');\n        var preTopScore = cc.sys.localStorage.getItem('topScore');\n        if (!preTopScore || parseInt(preTopScore) < parseInt(currentScore)){\n           cc.sys.localStorage.setItem('topScore', currentScore); \n        }\n        if(!preData){\n            preData = [];\n            preData.unshift(scoreData);\n        } else {\n            preData = JSON.parse(preData);\n\t        if (!(preData instanceof Array)){\n                preData = [];    \n            }\n            preData.unshift(scoreData);\n        }\n        cc.sys.localStorage.setItem('currentScore', currentScore);\n        cc.sys.localStorage.setItem('score', JSON.stringify(preData));\n    },\n    removeEnemy: function() {\n        var cannons = [];\n        cannons = this.enemyGroup.node.children;\n        for(var i = 0; i < cannons.length; i++){\n            cannons[i].group = 'default';\n            var animName = cannons[i].name + 'ani';\n            var anim = cannons[i].getComponent(cc.Animation);\n            anim.play(animName);\n            this.addScore(100);\n        }\n    },\n    getItemBomb: function() {\n        if (parseInt(this.bombNoDisplay.string) < 5){\n            this.bombNoDisplay.string += 1;\n        }   \n    },\n    gameOver: function(){ \n        // this.pauseAction();\n        this.updateScore();\n        cc.director.loadScene('end');\n    },\n});\n"]}