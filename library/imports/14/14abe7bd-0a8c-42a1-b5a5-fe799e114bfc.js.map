{"version":3,"sources":["../../../../assets/Script/assets/Script/enemy.js"],"names":["cc","Class","extends","Component","properties","xMinSpeed","default","type","Integer","displayName","xMaxSpeed","yMinSpeed","yMaxSpeed","initHP","initSpriteFrame","SpriteFrame","score","enemyDownClip","AudioClip","onLoad","director","getCollisionManager","enabled","xSpeed","Math","random","ySpeed","random0To1","enemyGroup","node","parent","getComponent","init","group","hP","nSprite","Sprite","spriteFrame","update","dt","eState","D","commonInfo","gameState","start","scores","getScore","y","x","height","enemyDied","onCollisionEnter","other","self","bullet","hpDrop","anim","Animation","animName","name","play","on","onFinished","audioEngine","playEffect","event"],"mappings":"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","file":"enemy.js","sourceRoot":"../../../../assets/Script","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    properties: {\n        xMinSpeed: {\n            default:0,\n            type:cc.Integer,\n            displayName: 'x轴最小速度',\n        },\n        xMaxSpeed: {\n            default:0,\n            type:cc.Integer,\n            displayName: 'x轴最大速度',\n        },\n        yMinSpeed: {\n            default:0,\n            type:cc.Integer,\n            displayName: 'y轴最小速度',\n        },\n        yMaxSpeed: { \n            default:0,\n            type:cc.Integer,\n            displayName: 'y轴最大速度',\n        },\n        initHP: {\n            default:0,\n            type:cc.Integer,\n            displayName: '初始生命值',\n        }, \n        initSpriteFrame:{\n            default: null,\n            type: cc.SpriteFrame,\n            displayName: '初始化的图像'\n        }, \n        score: {\n            default:0,\n            type:cc.Integer,\n            displayName: '死后获得的积分'\n\n        },\n        enemyDownClip: {\n          type: cc.AudioClip,\n          default: null\n        }\n    },\n    onLoad: function () {\n        cc.director.getCollisionManager().enabled=true;\n        this.xSpeed = Math.random()*(this.xMaxSpeed-this.xMinSpeed) + this.xMinSpeed;\n        this.ySpeed = cc.random0To1()*(this.yMaxSpeed-this.yMinSpeed) + this.yMinSpeed;\n        this.enemyGroup = this.node.parent.getComponent('enemyGroup');\n        \n    },\n    init: function(){\n        if (this.node.group != 'enemy'){\n            this.node.group = 'enemy';\n        }\n        if (this.hP != this.initHP){\n            this.hP = this.initHP;\n        }\n        var nSprite = this.node.getComponent(cc.Sprite);\n        if (nSprite.spriteFrame != this.initSpriteFrame){\n            nSprite.spriteFrame = this.initSpriteFrame;\n        }\n    },\n    update: function (dt) {\n        if (this.enemyGroup.eState != D.commonInfo.gameState.start){\n            return ;\n        }\n        var scores = this.enemyGroup.getScore();\n        if(scores<=50000){\n            this.node.y += dt*this.ySpeed;\n        }\n        else if(scores>50000&&scores<=100000){\n            this.node.y += dt*this.ySpeed-0.5;\n        }\n        else if(scores>100000&&scores<=150000){\n            this.node.y += dt*this.ySpeed-1;\n        }\n        else if(scores>150000&&scores<=200000){\n            this.node.y += dt*this.ySpeed-1.5;\n        }\n        else if(scores>200000&&scores<=300000){\n            this.node.y += dt*this.ySpeed-2;\n        } else{\n            this.node.y += dt*this.ySpeed-3;\n        }\n        this.node.x += dt*this.xSpeed;\n        if (this.node.y < -this.node.parent.height/2){\n            this.enemyGroup.enemyDied(this.node,0);\n        }\n    },\n    onCollisionEnter: function(other,self){\n        if (other.node.group != 'bullet'){\n            return ;\n        }\n        var bullet = other.node.getComponent('bullet');\n        \n        if (this.hP>0){\n            this.hP -= bullet.hpDrop;\n        } else {\n            return ;\n        }\n        if (this.hP <= 0){\n            this.node.group = 'default';\n            var anim = this.getComponent(cc.Animation);\n            var animName = self.node.name + 'ani';\n            anim.play(animName);\n            anim.on('finished',  this.onFinished, this);\n            cc.audioEngine.playEffect(this.enemyDownClip, false);  \n        }\n    },\n    onFinished: function(event) { \n        this.enemyGroup.enemyDied(this.node, this.score);\n    },\n    \n});\n"]}