{"version":3,"sources":["../../../../assets/Script/assets/Script/itemGroup.js"],"names":["itemG","cc","Class","name","properties","default","displayName","freqTime","prefab","type","Prefab","initPoolCount","minDelay","maxDelay","extends","Component","onLoad","eState","D","commonInfo","gameState","none","common","batchInitObjPool","startAction","start","i","length","fName","e","randNewItem","bind","schedule","ufoInfo","delay","Math","random","scheduleOnce","getNewItem","poolName","newNode","genNewNode","node","newV2","getNewItemPositon","setPosition","newUfo","randx","parent","width","randy","height","v2","pauseAction","enabled","pause","resumeAction","ufoDied","nodeinfo","backObjPool"],"mappings":"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","file":"itemGroup.js","sourceRoot":"../../../../assets/Script","sourcesContent":["var itemG = cc.Class({\n    name:'itemG', \n    properties: {\n        name:{\n            default: '',\n            displayName: '资源组名'\n        },\n        freqTime:{\n            default: 0,\n            displayName: '频率'\n        },\n        prefab:{\n            default: null,\n            type: cc.Prefab,\n            displayName: '预载资源',\n        },\n        initPoolCount:0,\n        minDelay:{\n            default:0,\n            displayName: '最小延迟',\n        },\n        maxDelay:{\n            default:0,\n            displayName: '最大延迟',\n        },\n    }\n});\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        itemG: {\n            default:[],\n            type: itemG\n        },\n    },\n    onLoad: function () {\n        this.eState = D.commonInfo.gameState.none;\n        D.common.batchInitObjPool(this,this.itemG);        \n        \n    },\n    startAction(){\n        this.eState = D.commonInfo.gameState.start;\n        for (var i = 0; i< this.itemG.length; ++i){\n            var freqTime = this.itemG[i].freqTime;\n            var fName = 'callback_'+ i;\n            this[fName] = function(e){ this.randNewItem(this.itemG[e]); }.bind(this, i);\n            this.schedule(this[fName], freqTime);\n        }\n    },\n    randNewItem: function(ufoInfo){\n        var delay = Math.random()*(ufoInfo.maxDelay-ufoInfo.minDelay) + ufoInfo.minDelay;\n        this.scheduleOnce(function(e) {this.getNewItem(e);}.bind(this, ufoInfo), delay);\n    },\n    getNewItem: function(ufoInfo) {\n        var poolName = ufoInfo.name + 'Pool';\n        var newNode = D.common.genNewNode(this[poolName],ufoInfo.prefab,this.node);\n        var newV2 = this.getNewItemPositon(newNode);\n        newNode.setPosition(newV2);\n    },\n    getNewItemPositon: function(newUfo) {\n        var randx = (Math.random() - 0.5) * 2 *(this.node.parent.width/2-newUfo.width/2);\n        var randy = this.node.parent.height/2+newUfo.height/2;\n        return cc.v2(randx,randy);\n    },\n    pauseAction: function(){\n        // cc.director.pause();\n        this.enabled = false;\n        this.eState = D.commonInfo.gameState.pause;\n    },\n    resumeAction: function(){\n        // cc.director.resume();\n        this.enabled = true;\n        this.eState = D.commonInfo.gameState.start;\n    },\n    ufoDied: function(nodeinfo){\n        D.common.backObjPool(this,nodeinfo);\n    },\n});\n"]}