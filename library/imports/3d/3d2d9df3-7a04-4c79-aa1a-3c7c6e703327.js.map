{"version":3,"sources":["../../../../assets/Script/assets/Script/bulletGroup.js"],"names":["bPosition","cc","Class","name","properties","xAxis","default","displayName","yAxis","bulletInfinite","freqTime","initPollCount","prefab","Prefab","position","type","bulletFiniteG","extends","finiteTime","orginName","Component","hero","Node","onLoad","eState","D","commonInfo","gameState","none","common","initObjPool","batchInitObjPool","startAction","start","getNewbullet","bICallback","bind","schedule","pauseAction","enabled","pause","resumeAction","changeBullet","itemBulletName","unschedule","bFCallback","i","length","e","delay","macro","REPEAT_FOREVER","bulletInfo","poolName","bc","newNode","genNewNode","node","newV2","getBulletPostion","setPosition","getComponent","bulletGroup","posInfo","hPos","getPosition","newV2_x","x","eval","newV2_y","y","p","bulletDied","nodeinfo","backObjPool"],"mappings":"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","file":"bulletGroup.js","sourceRoot":"../../../../assets/Script","sourcesContent":["var bPosition = cc.Class({\n    name: 'bPosition',\n    properties: {\n        xAxis: {\n            default:'',\n            displayName: 'x轴相对hero',\n        },\n        yAxis: {\n            default:'',\n            displayName: 'y轴相对hero'\n        },\n    },\n});\nvar bulletInfinite = cc.Class({\n    name:'bulletInfinite',\n    properties: {\n        name:'',\n        freqTime:{\n            default: 0,\n            displayName: '射速'\n        },\n        initPollCount:0,\n        prefab:cc.Prefab,\n        position: {\n            default: [],\n            type: bPosition,\n            displayName: '子弹位置',\n        }\n    }\n});\nvar bulletFiniteG = cc.Class({\n    name:'bulletFiniteG',\n    extends:bulletInfinite,\n    properties: {\n        finiteTime:0,\n        orginName:'',\n    }\n}); \ncc.Class({\n    extends: cc.Component,\n    properties:()=> ({\n        bulletInfinite: {\n            default:null,\n            type: bulletInfinite,\n            displayName:'无限时长子弹组'\n        },\n        bulletFiniteG: {\n            default:[],\n            type: bulletFiniteG,\n            displayName:'有限时长子弹组'\n        },\n        hero: cc.Node,\n    }),\n    onLoad: function () {\n        this.eState = D.commonInfo.gameState.none;\n        D.common.initObjPool(this,this.bulletInfinite);\n        D.common.batchInitObjPool(this,this.bulletFiniteG);\n    },\n    \n    startAction: function(){\n        this.eState = D.commonInfo.gameState.start;\n        this.getNewbullet(this.bulletInfinite);\n        this.bICallback = function(){this.getNewbullet(this.bulletInfinite);}.bind(this);\n        this.schedule(this.bICallback, this.bulletInfinite.freqTime);\n    },\n    pauseAction: function(){\n        // cc.director.pause();\n        this.enabled = false;\n        this.eState = D.commonInfo.gameState.pause;\n    },\n    resumeAction: function(){\n        // cc.director.resume();\n        this.enabled = true;\n        this.eState = D.commonInfo.gameState.start;\n    },\n    changeBullet: function(itemBulletName){\n        this.unschedule(this.bICallback);\n        this.unschedule(this.bFCallback);\n        for (var i=0; i<this.bulletFiniteG.length; i++){\n            if (this.bulletFiniteG[i].orginName == itemBulletName){\n                this.bFCallback = function(e){this.getNewbullet(this.bulletFiniteG[e]);}.bind(this,i);\n                this.schedule(this.bFCallback, this.bulletFiniteG[i].freqTime,this.bulletFiniteG[i].finiteTime);\n                var delay = this.bulletFiniteG[i].freqTime * this.bulletFiniteG[i].finiteTime;\n                this.schedule(this.bICallback, this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,delay);\n            }\n        }\n    },\n    getNewbullet: function (bulletInfo) {\n        var poolName = bulletInfo.name + 'Pool';\n        for (var bc=0; bc<bulletInfo.position.length; bc++){\n            var newNode = D.common.genNewNode(this[poolName],bulletInfo.prefab,this.node);\n            var newV2 = this.getBulletPostion(bulletInfo.position[bc]);\n            newNode.setPosition(newV2);\n            newNode.getComponent('bullet').bulletGroup = this;\n        }\n    },\n    getBulletPostion: function(posInfo){\n        var hPos = this.hero.getPosition();\n        var newV2_x = hPos.x + eval(posInfo.xAxis);\n        var newV2_y = hPos.y + eval(posInfo.yAxis);\n        return cc.p(newV2_x, newV2_y); \n    },\n    bulletDied: function(nodeinfo){\n        D.common.backObjPool(this,nodeinfo);\n    },\n});\n"]}